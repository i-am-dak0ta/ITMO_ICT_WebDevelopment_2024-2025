# Клиенты, проживавшие в те же дни

### Описание

Этот эндпоинт возвращает список клиентов, проживавших в гостинице в те же дни, что и указанный клиент, в определённый период времени.

---

### URL

`GET /clients/stay-overlap`

---

### Параметры запроса

Эндпоинт принимает параметры в строке запроса (`query parameters`).

| Параметр     | Тип данных | Обязательный | Описание                                                                 |
|--------------|------------|--------------|--------------------------------------------------------------------------|
| `client_id`  | `integer`  | Да           | ID клиента, для которого ищутся пересечения проживания.                  |
| `start_date` | `string`   | Нет          | Дата начала периода (формат `YYYY-MM-DD`).                               |
| `end_date`   | `string`   | Нет          | Дата окончания периода (формат `YYYY-MM-DD`).                            |

---

### Пример запроса

```http
GET /clients/stay-overlap?client_id=1&start_date=2024-01-01&end_date=2024-01-10
```

---

### Успешный ответ (200)

```json
{
    "count": 2,
    "clients": [
        {
            "id": 2,
            "passport_number": "0987654321",
            "first_name": "Анна",
            "last_name": "Смирнова",
            "middle_name": null,
            "city_from": "Москва"
        },
        {
            "id": 3,
            "passport_number": "5678901234",
            "first_name": "Иван",
            "last_name": "Кузнецов",
            "middle_name": "Петрович",
            "city_from": "Санкт-Петербург"
        }
    ]
}
```

#### Поля ответа

| Поле              | Тип данных    | Описание                                                       |
|--------------------|---------------|---------------------------------------------------------------|
| `count`            | `integer`     | Общее количество найденных клиентов.                          |
| `clients`          | `array`       | Список клиентов, чье проживание пересекалось с указанным.      |
| `clients.id`       | `integer`     | ID клиента.                                                   |
| `clients.passport_number` | `string` | Номер паспорта клиента.                                       |
| `clients.first_name`       | `string` | Имя клиента.                                                  |
| `clients.last_name`        | `string` | Фамилия клиента.                                              |
| `clients.middle_name`      | `string/null` | Отчество клиента, если указано.                              |
| `clients.city_from`        | `string` | Город, из которого прибыл клиент.                            |

---

### Ошибки

#### Неверный запрос (422)

Пример ответа:

```json
{
    "detail": "Дата окончания не может быть раньше даты начала."
}
```

| Код   | Описание                                                         |
|-------|-----------------------------------------------------------------|
| 422   | Некорректные данные, например, дата окончания раньше даты начала. |

#### Клиент не найден (404)

Пример ответа:

```json
{
    "detail": "Клиент с id 1 не найден."
}
```

#### Пересечения не найдены (404)

Пример ответа:

```json
{
    "detail": "Не найдено клиентов, проживавших в те же дни, что и указанный клиент."
}
```

---

### Примечания

- Параметр `client_id` обязателен. Если он не указан или клиент с этим ID не найден, запрос завершится ошибкой.
- Параметры `start_date` и `end_date` не обязательны. Если они не указаны, поиск ведется по всем датам проживания указанного клиента.
- Дата окончания (`end_date`) не может быть раньше даты начала (`start_date`).
- Если ни один клиент не найден, пересекающийся с указанным, будет возвращен код ответа `404` с соответствующим сообщением.